"use strict";exports.id=120,exports.ids=[120],exports.modules={4909:(e,t,l)=>{l.a(e,(async(e,o)=>{try{l.d(t,{H3:()=>I,MU:()=>g,OB:()=>w,Sx:()=>v,UD:()=>d,g0:()=>C,gy:()=>h,mt:()=>f,w$:()=>A,zX:()=>b});var s=l(3257),a=l(5725),n=l(3050),c=l(8968),r=l(9530),i=l(2081),u=l(4945),y=l(638),m=l(5108),p=e([s,a,n,c,r,i,u,y]);function g(e,t,l,o){m.log("Current layerID and node",e,t);const s=undefined;l.features[Number(t)].style.opacity="1";const a=o[Number(t)];return null!=a&&(a.style.opacity="1"),{frames:l,matFrames:o}}function v(){const e=c.select(".path1").style("opacity",1),t=c.select(".poolingFrame").style("opacity",1),l=c.select("#fr1").style("opacity",1);m.log("mouse in",e,t,l),m.log("signal!")}function f(){c.select(".path1").style("opacity",.02),c.select(".poolingFrame").style("opacity",.25),c.select("#fr1").style("opacity",.25),m.log("signal out!")}function h(e,t,l,o){m.log("Current layerID and node",e,t);const s=undefined;l.features[Number(t)].style.opacity="0.25";const a=o[Number(t)];return null!=a&&(a.style.opacity="0"),{frames:l,matFrames:o}}function d(e,t,l,o,s,n,r,i,u,y,p,g){return m.log("click!",t,l),c.selectAll(".procVis").transition().duration(1e3).attr("opacity",0),setTimeout((()=>{c.selectAll(".procVis").remove()}),2e3),c.select(".poolingFrame").style("opacity",.25),c.selectAll(".colFrame").style("opacity",0),c.selectAll(".rowFrame").style("opacity",0),c.selectAll(".frame").style("opacity",.25),c.selectAll(".featureVis").style("opacity",1),c.selectAll(".oFeature").style("opacity",1).style("pointer-events","auto"),"GCNConv"==o?s>=0&&((0,a.pg)(s,-(3*(p+2)+5*y*2)),s=-1):"pooling"==o?((0,a.pg)(3,-300),n&&i?.on("mouseout",n),r&&i?.on("mouseover",r),c.select(".poolingFrame").style("opacity",.25)):"result"==o?(0,a.pg)(5,-300):"resultLayer"==o?(c.select(".mats").selectAll(".resultRect").style("pointer-events","none"),g.forEach((e=>{e.style.fill="gray"})),(0,a.pg)(3,-250)):(0,a.pg)(4,-300),setTimeout((()=>{c.select(".pooling").style("pointer-events","auto").style("opacity",1),c.selectAll(".resultRect").style("pointer-events","none"),c.selectAll(".resultRect").style("pointer-events","auto").on("mouseover",(function(e,t){v()})),c.selectAll(".resultRect").style("pointer-events","auto").on("mouseout",(function(e,t){f()})),c.selectAll(".twoLayer").style("pointer-events","auto").style("opacity",1),c.selectAll("path").style("opacity",.05),c.select(".mats").selectAll(".lastLayerConnections").style("opacity",.25)}),1750),u.forEach(((e,t)=>{e.style.opacity="1"})),c.select(e.target).classed("featureVis")||c.select(e.target).classed("pooling")||c.select(e.target).classed("twoLayer")||(t=!1,l=!1),{dview:t,lock:l,transState:o,recordLayerID:s,poolingOutEvent:n,poolingOverEvent:r,poolingVis:i,colorSchemesTable:u}}function A(e,t,l,o,s,a,n,c){if(m.log("Current layerID and node",e,t),null!=l){m.log("grouped",l[e][t]);const o=undefined;l[e][t].forEach((e=>{e.style.opacity="1"}))}let r=null;r=0==e?o.GCNConv1[t]:1==e?o.GCNConv2[t]:o.GCNConv3[t],null!=r&&(r.style.opacity="1");let i=s[t],u=null;return 0==Number(e)?u=o.features:1==Number(e)?u=o.GCNConv1:2==Number(e)&&(u=o.GCNConv2),m.log("prev",e,i,u),null!=u&&i.forEach((e=>{u[e].style.opacity="1"})),null!=a&&i.forEach((e=>{e==t&&a[e]||(a[e].style.opacity="1")})),null!=n&&(n[t].style.opacity="1"),{paths:l,frames:o,matFrames:a,colFrames:n}}function C(e,t,l,o,s,a,n){if(m.log("Current layerID and node",e,t),null!=l){m.log("grouped",l[e][t]);const o=undefined;l[e][t].forEach((e=>{e.style.opacity="0.05"}))}let c=null;c=0==e?o.GCNConv1[t]:1==e?o.GCNConv2[t]:o.GCNConv3[t],null!=c&&(c.style.opacity="0.25");let r=s[t],i=null;return 0==Number(e)?i=o.features:1==Number(e)?i=o.GCNConv1:2==Number(e)&&(i=o.GCNConv2),m.log("prev",e,r,i),null!=i&&r.forEach((e=>{i[e].style.opacity="0.25"})),null!=a&&r.forEach((e=>{a[e]&&(a[e].style.opacity="0")})),null!=n&&(n[t].style.opacity="0"),{paths:l,frames:o,matFrames:a,colFrames:n}}function w(e,t,l,o,s,a,n,c){t.paths[e].style.opacity=c;let r=l.results[e];null!=r&&(r.style.opacity=n);let i=l.GCNConv3;null!=i&&(i[e].style.opacity=n),null!=a&&(a[e].style.opacity=n)}function I(e,t,l,o,n,p,g,v,f,h,d,A,C,w,I,b,N,V,F,D,G="relu"){let L,S,B,x,M=0,k=!1;const E=10;m.log("Current layerID and node",e,t),(0,a.pg)(e,3*(V+2)+5*I*2),l=e,m.log("CST before modification",o),o.forEach(((e,t)=>{m.log(`Before modification: Element ${t} opacity`,e.style.opacity),e.style.opacity="0.2",m.log(`After modification: Element ${t} opacity`,e.style.opacity)})),o[e].style.opacity="1",o[e+1].style.opacity="1";let U=[],R=n[t];for(let t=0;t<R.length;t++){let l=R[t];p[e][l].style.opacity="1";let o=(0,a.mA)(p,e,l,I,F,N,D);U.push(o)}let T=p[e+1][t];T.style.opacity="0.25",c.select(T).selectAll(".frame").attr("opacity",1);let P=(0,a.mA)(p,e,t,I,F,N,D);m.log("coord",P);let O=(0,s.I8)(P);O[0]+=V+2;let $=[];for(let e=0;e<n.length;e++)$.push(n[e].length);const _=(0,r.create)(r.all,{});let q=[g,v,f],z=new Array(q[e][t].length).fill(0),H=[];for(let l=0;l<n[t].length;l++){let o=t,s=n[o][l],a=1/Math.sqrt($[o]*$[s]);H.push(a),m.log("compute x loop",q[e][s]);const c=[...q[e][s]];let r=_.matrix(c);z=_.add(_.multiply(c,a),z)}const Y=_.multiply(_.transpose(A[e]),z),X=_.transpose(A[e]);m.log("compute x'",H,$,e,z.toString(),Y);const j=c.select(".mats").append("g").attr("class","procVis");let J=5,Q;X[0].length<I?(J=10,m.log("compute x 0")):X[0].length<10&&(J=10);let K=1;const W=n.length/2;t<W&&(K=-1);let Z=null,ee=[],te=[],le=[O[0]+(V+2)+N*I,O[1]],oe=[O[0]+(V+2)+N*I,O[1]];Z=[O[0],O[1]-50],t<W&&(K=-1),m.log("curveDir",K);const se=h[e];le[1]+=50*K;let ae=(0,s.I8)(le);0==e&&34==F&&(ae[0]+=50);const ne=[le[0]+N*I,le[1]-50*K];L=[ae[0]+N*I,ae[1]];let ce=(0,a.mA)(p,e,t,I,F,N,D);x=[ce[0]+3*(V+2)+N*I*2+(V+2),ce[1]],4==I&&(x[0]+=15);const re=(ne[0]+x[0])/2,ie=(L[0]+x[0])/2,ue=[re-20,ne[1]],ye=[re+20,x[1]];S=[ie-20,L[1]],B=[ie+20,x[1]];let me=[ne[0]-N*I*2-(V+2),ne[1]-b/2*K],pe=[ne[0]-N*I,ne[1]-b/2*K];4==I&&0==e&&(pe=[ne[0]+10,ne[1]-b/2*K],oe=[ne[0]+10,O[1]]);const ge=[O[0]+I*N+15,ue[1]];for(let e=0;e<X[0].length;e++){let t=[me[0]+J*e+J/2,me[1]];ee.push(t)}for(let e=0;e<I;e++){let t=[pe[0]+N*e+N/2,pe[1]];te.push(t)}m.log("curNode",T,c.select(T).selectAll(".frame"));const ve=1e3,fe=500,he=250*I,de=c.select(".mats").append("g"),Ae=10;let Ce=ge[0];const we=ge[1]+b;0==e&&34==F&&(Ce+=100);let Ie=(0,i.Rv)(Ce,we,K,N,I,A,e),be=[{func:()=>(0,i.PY)(j,z,O,J,b,d,U,H,K),delay:1500},{func:()=>{(0,u.C)(de,Ce,we-30,"./assets/SVGs/matmul.svg"),(0,a._T)(j,Ce,we-36,"Click for Animation","procVis"),(0,i.yP)([O],oe)},delay:1e3},{func:()=>{(0,i.g)(Ce,we,K,N,b,I,A,e,d,j,Ie)},delay:fe},{func:()=>(0,i.OI)(j,Y,oe,b,N,d,A[e],ee,te,K,Ie,I,z),delay:fe},{func:()=>(0,i.v)(j,I,b,N,ae,d,se,e),delay:fe},{func:()=>(0,i.tY)(L,S,B,x,e,I),delay:fe},{func:()=>(0,i.au)(ne,ue,ye,x,e,I),delay:1},{func:()=>(0,i.D1)(ie,ne,L,x),delay:fe},{func:()=>{T.style.opacity="1"},delay:fe},{func:()=>{c.select(".ctrlBtn").style("pointer-events","auto")},delay:1}];function Ne(){return m.log("return intervalID",Q),Q}"tanh"==G&&(be[7].func=()=>(0,i.TO)(ie,ne,L,x)),i.vB.runAnimations(0,be);let Ve=!0;return de.on("mouseover",(function(e,t){const[l,o]=c.pointer(e);(0,y.Oy)(l,o,"Matrix Multiplication","Click the icon to show the matrix multiplication process!")})),de.on("mouseout",(function(e,t){c.selectAll(".math-displayer").remove()})),de.on("click",(function(t,l){if(m.log("currentStep 1",M),m.log("isPlaying",k),t.stopPropagation(),Q&&clearInterval(Q),!k||M>=I||0==M){de.selectAll("*").remove(),(0,u.C)(de,Ce,we-30,"./assets/SVGs/playBtn_pause.svg"),Ve&&(c.selectAll(".removeRect").remove(),Ve=!1),m.log("currentStep",M),4==I&&2==e&&M>=2&&(c.select(".mats").selectAll(".removeRect").remove(),c.selectAll("#tempath").remove(),c.select(".wMatLink").style("opacity",1),c.selectAll(".matmul-displayer").remove(),M=0),M>=I&&(c.select(".mats").selectAll(".removeRect").remove(),M=0);const t=_.transpose(A[e]);c.select(".wMatLink").style("opacity",.3),Q=setInterval((()=>{(0,i.sy)(A[e],M,ee,te,K,d,I,oe,b,N,Y,j,Ie,z),c.selectAll(".columnUnit").style("opacity",0),c.selectAll(".weightUnit").style("opacity",.3).lower(),c.selectAll(`#weightUnit-${M}`).style("opacity",1).raise(),c.select(`#columnUnit-${M}`).style("opacity",1).raise(),M++,m.log("currentStep",M),4==I&&2==e&&M>=2&&(c.selectAll("#tempath").remove(),c.select(".wMatLink").style("opacity",1),c.selectAll(".matmul-displayer").remove(),c.selectAll(".weightUnit").style("opacity",1),c.selectAll(".columnUnit").style("opacity",0),(0,u.C)(de,Ce,we-30,"./assets/SVGs/matmul.svg"),k=!1,clearInterval(Q)),M>=I&&c.select(".mats").select(".ctrlBtn").style("pointer-events","none"),(M>=I||!C)&&(c.selectAll("#tempath").remove(),c.select(".wMatLink").style("opacity",1),c.selectAll(".matmul-displayer").remove(),c.selectAll(".weightUnit").style("opacity",1),c.selectAll(".columnUnit").style("opacity",0),(0,u.C)(de,Ce,we-30,"./assets/SVGs/matmul.svg"),k=!1,clearInterval(Q))}),200),w(Q),k=!0}else k&&(de.selectAll("*").remove(),(0,u.C)(de,Ce,we-30,"./assets/SVGs/playBtn_play.svg"),k=!1);c.selectAll("#tempath").lower()})),{getIntervalID:Ne,recordLayerID:l,colorSchemesTable:o,featureVisTable:p,features:g}}function b(e,t,l,o,p,g,v){const f=300,h=c.line().curve(c.curveBasis);let d,A,C,w=0,I=!1,b=null;const N=15,V=5,F=(0,s.qo)(".mats",".pooling");let D=(0,s.I8)(F);D[0][1]+=15,D[0][0]-=2.5*g,F[0][0]+=1.5*g;const G=(0,a.Pl)();F[0][1]+=10,l=(0,s.I8)(F);let L=(0,s.I8)(F),S;L[0][0]+=g,l[0][1]-=7.5,(0,s.I8)(F)[0][1]+=300,c.selectAll(".twoLayer").style("pointer-events","none"),c.selectAll("path").style("opacity",0),c.selectAll(".featureVis").style("opacity",.2),c.selectAll(".oFeature").style("opacity",.2),e?.style("opacity",.2);const B=4;(0,a.pg)(4,300),l[0][0]+=350;let x=(0,s.I8)(l),M=[];for(let e=0;e<g;e++){let t=[D[0][0]+5*e+2.5,D[0][1]-N+2];M.push(t)}let k=[];for(let e=0;e<2;e++)k.push([l[0][0]+N*e+7.5,l[0][1]]);const E=[[l[0][0]-150-7.5,l[0][1]],[l[0][0]-150+7.5,l[0][1]]],U=[[l[0][0]-150,l[0][1]],[l[0][0]-150+N,l[0][1]]];let R=(0,s.I8)(k);R[0][1]+=N,R[1][1]+=N;const T=c.select(".mats").append("g").attr("class","procVis"),P=[l[0][0],l[0][1]+7.5];let O=(0,s.I8)(k);O[0][0]+=118.75,O[1][0]+=118.75,O[0][1]+=N,O[1][1]+=N,m.log("comp coord",O,k),d=(0,s.I8)(x),d[0][0]-=160,d[0][1]-=50;const $=G.bias[3],_=[o[0]-$[0],o[1]-$[1]];c.select(".twoLayer").style("pointer-events","none");const q=(0,s.I8)(d);d[0][0]+=30,C=[l[0][0],l[0][1]+7.5],A=(0,n.bv)(d[0],C);const z=[E[0][0],E[0][1]+7.5],H=[E[0][0]+30,E[0][1]+7.5],Y=[l[0][0],l[0][1]+7.5],X=c.select(".mats").append("g").attr("class","ctrlBtn"),j=10,J=(L[0][0]+z[0])/2,Q=z[1]-7.5,K=undefined,W=(0,r.create)(r.all,{}).transpose(G.weights[3]);let Z=null;m.log("w mat pos",W);let ee=(0,i.Rv)(J+42,Q+30,-1,5,g,[W],0);m.log("w mat pos 1",ee);const te=[{func:()=>{(0,i.v)(T,$.length,N,N,q[0],p,$,4)},delay:200},{func:()=>{(0,i.XQ)(d,A,C)},delay:200},{func:()=>{(0,i.g)(J,Q+30,-1,5,N,g,[W],0,p,T,ee)},delay:f},{func:()=>{m.log("Xv check wmat",W),(0,i.OI)(T,_,z,N,N,p,W,M,U,1,ee,g,v)},delay:200},{func:()=>{(0,i.OI)(T,o,P,N,N,p,W,M,U,1,ee,g,v,"procVis wRect"),(0,i.yP)([L[0]],z),(0,i.yP)([H],Y)},delay:200},{func:()=>{Z=(0,i.UM)(R,O,o,p)},delay:200},{func:()=>{X.selectAll("*").remove(),(0,u.C)(X,J,Q,"./assets/SVGs/matmul.svg"),(0,a._T)(T,J,Q-12,"Click for Animation","procVis")},delay:200}],le=[{func:()=>{b=setInterval((()=>{const e=undefined,t=G.weights[3][w];(0,i.sy)(W,w,M,U,1,p,0,[E[0][0],E[0][1]+7.5],N,N,o,T,ee,v),c.selectAll(".columnUnit").style("opacity",0),c.selectAll(".weightUnit").style("opacity",.3).lower(),c.selectAll(`#weightUnit-${w}`).style("opacity",1).raise(),c.select(`#columnUnit-${w}`).style("opacity",1).raise(),w++,m.log("i",w),w>=2&&(c.selectAll(".matmul-displayer").remove(),c.selectAll(".weightUnit").style("opacity",1),c.selectAll(".columnUnit").style("opacity",0),X.selectAll("*").remove(),(0,u.C)(X,J,Q,"./assets/SVGs/matmul.svg"),clearInterval(b),c.selectAll("#tempath").transition().delay(200).duration(200).remove())}),250),c.selectAll("path").lower(),c.selectAll("path").lower()},delay:f}];i.vB.runAnimations(0,te),c.selectAll(".resultRect").style("pointer-events","auto").on("mouseover",(function(e){e.stopPropagation(),m.log("IN!");const t=Number(c.select(this).attr("id"));null!=Z&&(0,y.jN)(Z,k,o,t,p)})).on("mouseout",(function(e){c.selectAll(".math-displayer").remove();const t=Number(c.select(this).attr("id"));null!=Z&&(Z[0][t].style.opacity="0.1",Z[1][t].style.opacity="0.1")}));let oe=!0;X.on("mouseover",(function(e,t){const[l,o]=c.pointer(e);(0,y.Oy)(l,o,"Matrix Multiplication","Click the icon to show the matrix multiplication process!")})),X.on("mouseout",(function(e,t){c.selectAll(".math-displayer").remove()})),X.on("click",(function(e,t){m.log("isPlaying",I),e.stopPropagation(),oe&&(c.select(".mats").selectAll(".removeRect").remove(),oe=!1),b&&clearInterval(b),!I||w>=2||0==w?(c.selectAll("#tempath").remove(),c.select(".wMatLink").style("opacity",1),c.selectAll(".matmul-displayer").remove(),(0,u.C)(X,J,Q,"./assets/SVGs/matmul.svg"),w>=2&&(c.selectAll(".matmul-displayer").remove(),c.select(".wMatLink").style("opacity",1),c.selectAll("#tempath").remove(),c.select(".mats").selectAll(".removeRect").remove(),w=0),le[0].delay=1,i.vB.runAnimations(0,le),I=!0):I&&(X.selectAll("*").remove(),(0,u.C)(X,J,Q,"./assets/SVGs/playBtn_pause.svg"),I=!1),c.selectAll("path").lower()}));for(let e=0;e<4;e++)t[e].style.opacity="0.2";return{resultVis:e,colorSchemesTable:t}}[s,a,n,c,r,i,u,y]=p.then?(await p)():p,o()}catch(N){o(N)}}))},8120:(e,t,l)=>{l.a(e,(async(e,o)=>{try{l.d(t,{J:()=>g,Yn:()=>v,qg:()=>y});var s=l(8968),a=l(3257),n=l(9341),c=l(5725),r=l(4801),i=l(5108),u=e([s,a,n,c,r]);function y(e){let t=Math.abs(Math.max(...e)),l=Math.abs(Math.min(...e));return l>t?l:t}async function m(e,t,l,o,u){i.log("start initNodeC");let m=null,p=(0,a.qt)(e),g=[],v=[],f=[],h=[],d=null;if(i.log("intmData",l),null!=l){let e=y(l.conv1);i.log("conv1Max",e);let t=y(l.conv2);i.log("conv2Max",t);let o=y(l.conv3);i.log("conv3Max",o);let s=y(l.final);i.log("finalMax",s);let n=y(l.result.map((e=>Array.from(e))).flat());i.log("resultMax",n,l.result.flat()),m={conv1:e,conv2:t,conv3:o,final:s,result:n},i.log("From Visualizer:",l),g=(0,a.uL)(l.conv1,4),v=(0,a.uL)(l.conv2,4),f=(0,a.uL)(l.conv3,2),h=l.result,d=(0,a.uL)(l.final,4)}i.log("path ",o);const A=e.length;i.log("gLen",A);const C=800,w={top:10,right:80,bottom:30,left:80},I=20*A+50+612+2400,b=2*(C+w.top+w.bottom);let N=[];s.select("#matvis").selectAll("*").remove(),(0,r.v7)(C,e,I,b,w);var V=s.scaleLinear().domain([-3,-1,-.1,0,.1,1,3]).range(["#304E30","#3DBA41","#B7EFB8","white","#BBB7EF","#6E09CD","#4B0092"]);const F=(0,a.G)(e);N=(0,c.w$)(F,N);const D=(0,n.H)(N,t,V,g,v,f,h,d,e,p,m,u);i.log("initNode",l,F,N,p),i.log("conv",g,v,f,d,h),i.log("initNode CST",m),i.log("initNode features",t)}async function p(e,t,l,o,u){let m=null,p=(0,a.qt)(e),g=[],v=[],f=[],h=[],d=null;if(i.log("intmData",o),null!=o){let e=y(o.conv1);i.log("conv1Max",e);let t=y(o.conv2);i.log("conv2Max",t);let l=y(o.conv3);i.log("conv3Max",l);let s=y(o.pooling);i.log("poolingMax",s);let n=y(o.dropout);i.log("dropMax",n);let c=y(o.final);i.log("finalMax",c),m={conv1:e,conv2:t,conv3:l,pooling:s,dropout:n,final:c},i.log("From Visualizer:",o),g=(0,a.uL)(o.conv1),v=(0,a.uL)(o.conv2),f=(0,a.uL)(o.conv3),h=o.pooling,d=o.final}i.log("from mat vis pooling",h),i.log("path ",u);let A=[];const C=e.length;i.log("gLen",C);const w=400,I={top:10,right:80,bottom:30,left:80},b=20*C+50+612+2400,N=2*(w+I.top+I.bottom);let V=[];s.select("#matvis").selectAll("*").remove(),(0,r.v7)(w,e,b,N,I);var F=s.scaleLinear().domain([-3,-1,-.1,0,.1,1,3]).range(["#304E30","#3DBA41","#B7EFB8","white","#BBB7EF","#6E09CD","#4B0092"]);const D=(0,a.G)(e);V=(0,c.w$)(D,V);const G=(0,n.P)(V,t,F,g,v,f,h,d,e,p,m);(0,c.hY)(l,e,50);const L=G.getIntervalID();i.log("get interval ID init G",L),clearInterval(L)}async function g(e,t,l){try{e(!0),i.log("path matvis",t);const o=await(0,a.LU)(t);i.log("data matvis",o),i.log("data.x",o.x);const s=(0,c.GF)(o);i.log("node attr array",s);const n=await(0,a.Gh)(o);i.log("o features",n);const r=await(0,a.qb)(o);i.log("pData matvis",r),await p(r,n,s,l,t)}catch(e){i.error("Error in visualizeGNN:",e)}finally{e(!1)}}async function v(e,t,l){try{e(!0),i.log("path matvis",t);const o=await(0,a.LU)(t);i.log("data matvis",o);const s=o.train_nodes;i.log("train nodes",s);const n=await(0,a.Gh)(o);i.log("o features",n);const c=await(0,a.qb)(o);i.log("pData matvis",c),await m(c,n,l,t,s)}catch(e){i.error("Error in visualizeGNN:",e)}finally{e(!1)}}[s,a,n,c,r]=u.then?(await u)():u,o()}catch(f){o(f)}}))},9341:(e,t,l)=>{l.a(e,(async(e,o)=>{try{l.d(t,{H:()=>v,P:()=>g});var s=l(5725),a=l(3050),n=l(8968),c=l(4909),r=l(2081),i=l(4945),u=l(638),y=l(9530),m=l(5108),p=e([s,a,n,c,r,i,u,y]);function g(e,t,l,o,r,i,u,y,p,g,v){let f=null,h=null,d=null,A=null;const C=(0,s.Pl)();m.log("weights, data",C);const w=C.weights,I=C.bias;m.log("weights, data",w,I);let b=[[],[],[],[]],N=[],V=!1,F=!1;var D={features:[],GCNConv1:[],GCNConv2:[],GCNConv3:[]},G=[];m.log("Received",v),m.log("adjList",g);const L=(0,a.v4)(p,e,400);let S=L.colFrames,B=L.matFrames;const x=(0,a._O)(e,p,l,t,D,G,b,7,10,15,100);e=x.locations,D=x.frames,G=x.schemeLocations,b=x.featureVisTable;const M=x.firstLayer,k=64,E=(0,a.i5)(o,r,i,e,l,D,G,b,u,p,N,h,d,y,M,v,k);e=E.locations,D=E.frames,G=E.schemeLocations,b=E.featureVisTable,N=E.colorSchemesTable,h=E.poolingVis,d=E.outputVis,A=E.resultVis,v=E.maxVals;let U=E.path1,R=E.fr1,T=E.poolingFrame,P=E.paths,O=E.one;clearInterval(f),n.selectAll(".oFeature").on("mouseover",(function(e,t){if(!F){const e=n.select(this).attr("layerID"),t=n.select(this).attr("node"),l=(0,c.MU)(e,t,D,B);D=l.frames,B=l.matFrames}})),n.selectAll(".oFeature").on("mouseout",(function(e,t){const l=n.select(this).attr("layerID"),o=n.select(this).attr("node"),s=(0,c.gy)(l,o,D,B);D=s.frames,B=s.matFrames}));let $=-1,_="GCNConv",q=null,z=null;function H(e){f=e,m.log("Interval ID set to:",f)}function Y(){return m.log("get interval ID from vGCF",f),f}return n.selectAll(".mats, .switchBtn").on("click",(function(e,t){if((!e.target||"btn"!==e.target.id)&&F){const t=(0,c.UD)(e,V,F,_,$,z,q,h,N,k,100,[]);V=t.dview,F=t.lock,_=t.transState,$=t.recordLayerID,z=t.poolingOutEvent,q=t.poolingOverEvent,N=t.colorSchemesTable,m.log("interval .mats",f),clearInterval(f)}})),n.selectAll(".featureVis").on("click",(function(e,s){if(1!=F){_="GCNConv",F=!0,e.stopPropagation(),V=!0,m.log("click! - fVis",V,F),n.selectAll(".oFeature").style("pointer-events","none").style("opacity",.2),n.select(".pooling").style("pointer-events","none").style("opacity",.2),n.selectAll(".twoLayer").style("pointer-events","none").style("opacity",.2),n.selectAll(".crossConnection").style("opacity",0),n.selectAll(".featureVis").style("opacity",.2),n.selectAll(".oFeature").style("opacity",.2);const s=Number(n.select(this).attr("layerID"))-1,a=Number(n.select(this).attr("node")),i=(0,c.H3)(s,a,$,N,g,b,t,o,r,I,l,w,F,H,k,15,5,100,7,10);$=i.recordLayerID,N=i.colorSchemesTable,b=i.featureVisTable,t=i.features,f=i.getIntervalID(),m.log("interval",f)}})),n.selectAll(".featureVis").on("mouseover",(function(e,t){if(!F){const e=Number(n.select(this).attr("layerID"))-1,t=Number(n.select(this).attr("node")),l=(0,c.w$)(e,t,P,D,g,B,S,k);P=l.paths,D=l.frames,B=l.matFrames,S=l.colFrames}})),n.selectAll(".featureVis").on("mouseout",(function(e,t){if(!F){const e=Number(n.select(this).attr("layerID"))-1,t=Number(n.select(this).attr("node")),l=(0,c.g0)(e,t,P,D,g,B,S);P=l.paths,D=l.frames,B=l.matFrames,S=l.colFrames}})),null!=d&&(n.selectAll(".resultRect").style("pointer-events","auto").on("mouseover",(function(e,t){(0,c.Sx)()})),n.selectAll(".resultRect").style("pointer-events","auto").on("mouseout",(function(e,t){(0,c.mt)()})),n.selectAll(".resultRect").style("pointer-events","auto").on("click",(function(e,t){if(1!=F){n.select(".pooling").style("pointer-events","none"),_="output",F=!0,e.stopPropagation(),V=!0,m.log("click! - fVis",V,F);const t=(0,c.zX)(A,N,O,y,l,k,u);A=t.resultVis,N=t.colorSchemesTable}}))),{getIntervalID:Y}}function v(e,t,l,o,p,g,v,f,h,d,A,C){let w=null,I=null,b=null,N=null;const V=(0,s.vJ)();m.log("weights, data",V);const F=V.weights,D=V.bias;m.log("weights, data",F,D);let G=[[],[],[],[],[]],L=[],S=!1,B=!1;var x={features:[],GCNConv1:[],GCNConv2:[],GCNConv3:[],results:[]},M=[];m.log("Received",A),m.log("adjList",d);const k=(0,a.v4)(h,e,800);let E=k.colFrames,U=k.matFrames;const R=(0,a._O)(e,h,l,t,x,M,G,34,5,15,150);e=R.locations,x=R.frames,M=R.schemeLocations,G=R.featureVisTable;const T=R.firstLayer,P=4,O=(0,a.ql)(o,p,g,e,l,x,M,G,v,h,L,f,T,A,4,C);e=O.locations,x=O.frames,M=O.schemeLocations,G=O.featureVisTable,L=O.colorSchemesTable,A=O.maxVals;let $=O.resultLabelsList,_=O.paths,q=O.resultPaths;m.log("resultPaths in nc",q),n.selectAll(".oFeature").on("mouseover",(function(e,t){if(!B){const e=n.select(this).attr("layerID"),t=n.select(this).attr("node"),l=(0,c.MU)(e,t,x,U);x=l.frames,U=l.matFrames}})),n.selectAll(".oFeature").on("mouseout",(function(e,t){const l=n.select(this).attr("layerID"),o=n.select(this).attr("node"),s=(0,c.gy)(l,o,x,U);x=s.frames,U=s.matFrames}));let z=-1,H="GCNConv",Y=null,X=null;function j(e){w=e,m.log("Interval ID set to:",w)}function J(){return m.log("get interval ID from vGCF",w),w}return n.selectAll(".featureVis").on("mouseover",(function(e,t){if(!B){const e=Number(n.select(this).attr("layerID"))-1,t=Number(n.select(this).attr("node")),l=(0,c.w$)(e,t,_,x,d,U,E,4);_=l.paths,x=l.frames,U=l.matFrames,E=l.colFrames}})),n.selectAll(".featureVis").on("mouseout",(function(e,t){if(!B){const e=Number(n.select(this).attr("layerID"))-1,t=Number(n.select(this).attr("node")),l=(0,c.g0)(e,t,_,x,d,U,E);_=l.paths,x=l.frames,U=l.matFrames,E=l.colFrames}})),n.selectAll(".resultVis").on("mouseover",(function(e,t){if(!B){const e=Number(n.select(this).attr("node"));(0,c.OB)(e,q,x,d,U,E,"1","1"),$[e].style.fill="black"}})),n.selectAll(".resultVis").on("mouseout",(function(e,t){if(!B){const e=Number(n.select(this).attr("node"));(0,c.OB)(e,q,x,d,U,E,"0.25","0.25"),$[e].style.fill="gray"}})),n.selectAll(".mats, .switchBtn").on("click",(function(e,t){if((!e.target||"btn"!==e.target.id)&&B){n.selectAll(".resultVis").style("pointer-events","auto").style("opacity",1);const t=(0,c.UD)(e,S,B,H,z,X,Y,I,L,4,90,$);S=t.dview,B=t.lock,H=t.transState,z=t.recordLayerID,X=t.poolingOutEvent,Y=t.poolingOverEvent,L=t.colorSchemesTable,m.log("interval .mats",w),clearInterval(w)}})),n.selectAll(".featureVis").on("click",(function(e,s){if(1!=B){H="GCNConv",B=!0,e.stopPropagation(),S=!0,m.log("click! - fVis",S,B),n.selectAll(".resultVis").style("pointer-events","none").style("opacity",.2),n.selectAll(".oFeature").style("pointer-events","none").style("opacity",.2),n.select(".pooling").style("pointer-events","none").style("opacity",.2),n.selectAll(".twoLayer").style("pointer-events","none").style("opacity",.2),n.selectAll(".crossConnection").style("opacity",0),n.selectAll(".featureVis").style("opacity",.2),n.selectAll(".oFeature").style("opacity",.2);const s=Number(n.select(this).attr("layerID"))-1,a=Number(n.select(this).attr("node")),r=(0,c.H3)(s,a,z,L,d,G,t,o,p,D,l,F,B,j,4,15,10,90,34,5,"tanh");z=r.recordLayerID,L=r.colorSchemesTable,G=r.featureVisTable,t=r.features,w=r.getIntervalID(),m.log("interval",w)}})),n.selectAll(".resultVis").on("click",(function(e,t){if(1!=B){H="resultLayer",B=!0,e.stopPropagation(),S=!0,m.log("click! - fVis",S,B),n.selectAll(".resultVis").style("pointer-events","none").style("opacity",.2),n.selectAll(".oFeature").style("pointer-events","none").style("opacity",.2),n.select(".pooling").style("pointer-events","none").style("opacity",.2),n.selectAll(".twoLayer").style("pointer-events","none").style("opacity",.2),n.selectAll(".crossConnection").style("opacity",0),n.selectAll(".featureVis").style("opacity",.2),n.selectAll(".oFeature").style("opacity",.2);const t=3,o=Number(n.select(this).attr("node"));(0,s.pg)(3,250),m.log("CST before modification",L),L.forEach(((e,t)=>{m.log(`Before modification: Element ${t} opacity`,e.style.opacity),e.style.opacity="0.2",m.log(`After modification: Element ${t} opacity`,e.style.opacity)})),L[t].style.opacity="1",L[t+1].style.opacity="1",G[t][o].style.opacity="1";let c=G[t+1][o];c.style.opacity="0.25",n.select(c).selectAll(".frame").attr("opacity",1);let p=(0,s.mA)(G,t,o,2,34,10,5),h=[p[0]+150,p[1]],d=[p[0]+150+40,p[1]],A=[p[0]+450,p[1]],C=1;o<17&&(C=-1);let I=[p[0]+150,p[1]+50*C],b=[p[0]+250,p[1]],N=[b[0],b[1]],V=[N[0]-60,N[1]],F=[I[0]+40,I[1]];const D=p[1]-7.5*C;let x=[[p[0]-5,p[1]-7.5*C],[p[0]-15,p[1]-7.5*C]],M=[[h[0]+5,D],[h[0]+15,D],[h[0]+25,D],[h[0]+35,D]];const k=p[1]-7.5*C;let E=[[N[0]+5,k],[N[0]+15,k],[N[0]+25,k],[N[0]+35,k]],U=[[A[0]+5,k],[A[0]+15,k],[A[0]+25,k],[A[0]+35,k]];const R=(0,s.vJ)(),T=R.bias[3],P=R.weights[3],O=f[o],_=(0,y.create)(y.all,{}),q=[g[o][0],g[o][1]],z=_.multiply(q,_.transpose(P));m.log("data fetching in the NC result layer",T,P,O,g,z);const Y=n.select(".mats"),X=(0,a.bv)(F,b),j=X[0],J=X[1];let Q=0;o<17&&(Q=1),m.log("smart ui",G),o<17?(G[3][o+1].style.opacity="0",G[3][o+2].style.opacity="0",G[4][o+1].style.opacity="0",G[4][o+2].style.opacity="0"):(G[3][o-1].style.opacity="0",G[3][o-2].style.opacity="0",G[4][o-1].style.opacity="0",G[4][o-2].style.opacity="0");const K=n.select(".mats").append("g").attr("class","ctrlBtn"),W=10,Z=(p[0]+h[0])/2,ee=p[1]-7.5;let te=0;const le=300,oe=500,se=n.select(".mats").append("g").attr("class","procVis");let ae=null;const ne=_.transpose(R.weights[3]);let ce=(0,r.Rv)(Z,ee+30,C,15,4,[ne],0);const re=[{func:()=>{(0,r.g)(Z,ee+15,1,15,15,4,[ne],0,l,se,ce)},delay:oe},{func:()=>{const e=R.weights[3],t=[g[o][0],g[o][1]];m.log("data fetching wv 1",t),(0,r.OI)(Y,z,h,15,10,l,ne,x,M,C,ce,4,t),(0,r.yP)([p],h)},delay:oe},{func:()=>{(0,r.OI)(Y,O,N,15,10,l,ne,x,M,C,ce,4,q,"procVis wRect"),(0,r.yP)([V],N)},delay:oe},{func:()=>{(0,r.v)(Y,4,15,10,I,l,T,4)},delay:oe},{func:()=>{(0,r.tY)(F,j,J,b,4,4)},delay:oe},{func:()=>{(0,r.yP)([d],A)},delay:oe},{func:()=>{let e=1;1==Q&&(e=0),ae=(0,r.UM)(E,U,O,l,e)},delay:oe},{func:()=>{G[4][o].style.opacity="1",$[o].style.fill="black"},delay:oe}],ie=[{func:()=>{w=setInterval((()=>{const e=undefined,t=R.weights[3][te];(0,r.sy)(ne,te,x,M,C,l,0,h,15,10,z,se,ce,q),n.selectAll(".columnUnit").style("opacity",0),n.selectAll(".weightUnit").style("opacity",.3).lower(),n.selectAll(`#weightUnit-${te}`).style("opacity",1).raise(),n.select(`#columnUnit-${te}`).style("opacity",1).raise(),te++,m.log("i",te),te>=4&&(n.selectAll(".weightUnit").style("opacity",1),n.selectAll(".columnUnit").style("opacity",0),K.selectAll("*").remove(),(0,i.C)(K,Z,ee,"./assets/SVGs/matmul.svg"),n.selectAll("#tempath").remove(),n.selectAll(".matmul-displayer").remove(),clearInterval(w))}),250),n.selectAll("path").lower(),n.selectAll("path").lower()},delay:le+oe}];r.vB.runAnimations(0,re);let ue=!1;setTimeout((()=>{(0,i.C)(K,Z,ee,"./assets/SVGs/matmul.svg")}),le+2*oe);let ye=!0;K.on("mouseover",(function(e,t){const[l,o]=n.pointer(e);(0,u.Oy)(l,o,"Matrix Multiplication","Click the icon to show the matrix multiplication process!")})),K.on("mouseout",(function(e,t){n.selectAll(".math-displayer").remove()})),K.on("click",(function(e,t){ye&&(n.selectAll(".removeRect").remove(),ye=!1),m.log("isPlaying",ue),e.stopPropagation(),w&&clearInterval(w),!ue||te>=4||0==te?(n.selectAll("#tempath").remove(),n.selectAll(".matmul-displayer").remove(),K.selectAll("*").remove(),(0,i.C)(K,Z,ee,"./assets/SVGs/playBtn_pause.svg"),te>=4&&(n.selectAll("#tempath").remove(),n.selectAll(".matmul-displayer").remove(),n.select(".mats").selectAll(".removeRect").remove(),n.select(".mats").selectAll(".pauseRemove").remove(),te=0,G[4][o].style.opacity="0.25",$[o].style.fill="gray"),ie[0].delay=1,r.vB.runAnimations(0,ie),ue=!0):ue&&(K.selectAll("*").remove(),(0,i.C)(K,Z,ee,"./assets/SVGs/playBtn_play.svg"),ue=!1),n.selectAll("path").lower()})),n.select(".mats").selectAll(`rect#resultRect${o}`).style("pointer-events","auto").on("mouseover",(function(e,t){if(null!=ae){const e=["Softmax Score for 'Class A'","Softmax Score for 'Class B'","Softmax Score for 'Class C'","Softmax Score for 'Class D'"],t=n.select(this).attr("rectID");m.log("resultRect event",o,t);const s=v[o];m.log("data fetching result rect",ae,s,O,e[Number(t)]);for(let e=0;e<ae.length;e++)ae[e][t].style.opacity="1";let a=[p[0]+275,p[1]-100*C];(0,u.Se)(a,e,Number(t),O,s,l)}})),n.select(".mats").selectAll(`rect#resultRect${o}`).style("pointer-events","auto").on("mouseout",(function(e,t){if(null!=ae){const e=n.select(this).attr("rectID");for(let t=0;t<ae.length;t++)ae[t][e].style.opacity="0.1";n.selectAll(".math-displayer").remove()}}))}})),null}[s,a,n,c,r,i,u,y]=p.then?(await p)():p,o()}catch(f){o(f)}}))}};