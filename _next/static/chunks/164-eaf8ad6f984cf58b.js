"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[164],{3164:function(t,e,o){o.d(e,{qg:function(){return D},J:function(){return S},Yn:function(){return A}});var l=o(2434),s=o(7340),n=o(5725),a=o(3050),i=o(7170),r=o(9851),c=o(2081),u=o(4945),y=o(638),m=o(5108);function p(t,e,o,l){m.log("Current layerID and node",t,e);const s=undefined;o.features[Number(e)].style.opacity="1";const n=l[Number(e)];return null!=n&&(n.style.opacity="1"),{frames:o,matFrames:l}}function d(){const t=l.Ys(".path1").style("opacity",1),e=l.Ys(".poolingFrame").style("opacity",1),o=l.Ys("#fr1").style("opacity",1);m.log("mouse in",t,e,o),m.log("signal!")}function f(){l.Ys(".path1").style("opacity",.02),l.Ys(".poolingFrame").style("opacity",.25),l.Ys("#fr1").style("opacity",.25),m.log("signal out!")}function v(t,e,o,l){m.log("Current layerID and node",t,e);const s=undefined;o.features[Number(e)].style.opacity="0.25";const n=l[Number(e)];return null!=n&&(n.style.opacity="0"),{frames:o,matFrames:l}}function g(t,e,o,s,a,i,r,c,u,y,p,v){return m.log("click!",e,o),l.td_(".procVis").transition().duration(1e3).attr("opacity",0),setTimeout((()=>{l.td_(".procVis").remove()}),2e3),l.Ys(".poolingFrame").style("opacity",.25),l.td_(".colFrame").style("opacity",0),l.td_(".rowFrame").style("opacity",0),l.td_(".frame").style("opacity",.25),l.td_(".featureVis").style("opacity",1),l.td_(".oFeature").style("opacity",1).style("pointer-events","auto"),"GCNConv"==s?a>=0&&((0,n.pg)(a,-(3*(p+2)+5*y*2)),a=-1):"pooling"==s?((0,n.pg)(3,-300),i&&(null==c||c.on("mouseout",i)),r&&(null==c||c.on("mouseover",r)),l.Ys(".poolingFrame").style("opacity",.25)):"result"==s?(0,n.pg)(5,-300):"resultLayer"==s?(l.Ys(".mats").selectAll(".resultRect").style("pointer-events","none"),v.forEach((t=>{t.style.fill="gray"})),(0,n.pg)(3,-250)):(0,n.pg)(4,-300),setTimeout((()=>{l.Ys(".pooling").style("pointer-events","auto").style("opacity",1),l.td_(".resultRect").style("pointer-events","none"),l.td_(".resultRect").style("pointer-events","auto").on("mouseover",(function(t,e){d()})),l.td_(".resultRect").style("pointer-events","auto").on("mouseout",(function(t,e){f()})),l.td_(".twoLayer").style("pointer-events","auto").style("opacity",1),l.td_("path").style("opacity",.05),l.Ys(".mats").selectAll(".lastLayerConnections").style("opacity",.25)}),1750),u.forEach(((t,e)=>{t.style.opacity="1"})),l.Ys(t.target).classed("featureVis")||l.Ys(t.target).classed("pooling")||l.Ys(t.target).classed("twoLayer")||(e=!1,o=!1),{dview:e,lock:o,transState:s,recordLayerID:a,poolingOutEvent:i,poolingOverEvent:r,poolingVis:c,colorSchemesTable:u}}function h(t,e,o,l,s,n,a,i){if(m.log("Current layerID and node",t,e),null!=o){m.log("grouped",o[t][e]);const l=undefined;o[t][e].forEach((t=>{t.style.opacity="1"}))}let r=null;r=0==t?l.GCNConv1[e]:1==t?l.GCNConv2[e]:l.GCNConv3[e],null!=r&&(r.style.opacity="1");let c=s[e],u=null;return 0==Number(t)?u=l.features:1==Number(t)?u=l.GCNConv1:2==Number(t)&&(u=l.GCNConv2),m.log("prev",t,c,u),null!=u&&c.forEach((t=>{u[t].style.opacity="1"})),null!=n&&c.forEach((t=>{t==e&&n[t]||(n[t].style.opacity="1")})),null!=a&&(a[e].style.opacity="1"),{paths:o,frames:l,matFrames:n,colFrames:a}}function _(t,e,o,l,s,n,a){if(m.log("Current layerID and node",t,e),null!=o){m.log("grouped",o[t][e]);const l=undefined;o[t][e].forEach((t=>{t.style.opacity="0.05"}))}let i=null;i=0==t?l.GCNConv1[e]:1==t?l.GCNConv2[e]:l.GCNConv3[e],null!=i&&(i.style.opacity="0.25");let r=s[e],c=null;return 0==Number(t)?c=l.features:1==Number(t)?c=l.GCNConv1:2==Number(t)&&(c=l.GCNConv2),m.log("prev",t,r,c),null!=c&&r.forEach((t=>{c[t].style.opacity="0.25"})),null!=n&&r.forEach((t=>{n[t]&&(n[t].style.opacity="0")})),null!=a&&(a[e].style.opacity="0"),{paths:o,frames:l,matFrames:n,colFrames:a}}function C(t,e,o,l,s,n,a,i){e.paths[t].style.opacity=i;let r=o.results[t];null!=r&&(r.style.opacity=a);let c=o.GCNConv3;null!=c&&(c[t].style.opacity=a),null!=n&&(n[t].style.opacity=a)}function Y(t,e,o,a,p,d,f,v,g,h,_,C,Y,w,I,b,N,V,F,D){let G=arguments.length>20&&void 0!==arguments[20]?arguments[20]:"relu",L,S,A,k,B=0,x=!1;const E=10;m.log("Current layerID and node",t,e),(0,n.pg)(t,3*(V+2)+5*I*2),o=t,m.log("CST before modification",a),a.forEach(((t,e)=>{m.log("Before modification: Element ".concat(e," opacity"),t.style.opacity),t.style.opacity="0.2",m.log("After modification: Element ".concat(e," opacity"),t.style.opacity)})),a[t].style.opacity="1",a[t+1].style.opacity="1";let M=[],U=p[e];for(let e=0;e<U.length;e++){let o=U[e];d[t][o].style.opacity="1";let l=(0,n.mA)(d,t,o,I,F,N,D);M.push(l)}let R=d[t+1][e];R.style.opacity="0.25",l.Ys(R).selectAll(".frame").attr("opacity",1);let T=(0,n.mA)(d,t,e,I,F,N,D);m.log("coord",T);let P=(0,s.I8)(T);P[0]+=V+2;let O=[];for(let t=0;t<p.length;t++)O.push(p[t].length);const $=(0,i.U)(r.$,{});let q=[f,v,g],j=new Array(q[t][e].length).fill(0),z=[];for(let o=0;o<p[e].length;o++){let l=e,s=p[l][o],n=1/Math.sqrt(O[l]*O[s]);z.push(n),m.log("compute x loop",q[t][s]);const a=[...q[t][s]];let i=$.matrix(a);j=$.add($.multiply(a,n),j)}const J=$.multiply($.transpose(C[t]),j),X=$.transpose(C[t]);m.log("compute x'",z,O,t,j.toString(),J);const Q=l.Ys(".mats").append("g").attr("class","procVis");let Z=5,H;X[0].length<I?(Z=10,m.log("compute x 0")):X[0].length<10&&(Z=10);let K=1;const W=p.length/2;e<W&&(K=-1);let tt=null,et=[],ot=[],lt=[P[0]+(V+2)+N*I,P[1]],st=[P[0]+(V+2)+N*I,P[1]];tt=[P[0],P[1]-50],e<W&&(K=-1),m.log("curveDir",K);const nt=h[t];lt[1]+=50*K;let at=(0,s.I8)(lt);0==t&&34==F&&(at[0]+=50);const it=[lt[0]+N*I,lt[1]-50*K];L=[at[0]+N*I,at[1]];let rt=(0,n.mA)(d,t,e,I,F,N,D);k=[rt[0]+3*(V+2)+N*I*2+(V+2),rt[1]],4==I&&(k[0]+=15);const ct=(it[0]+k[0])/2,ut=(L[0]+k[0])/2,yt=[ct-20,it[1]],mt=[ct+20,k[1]];S=[ut-20,L[1]],A=[ut+20,k[1]];let pt=[it[0]-N*I*2-(V+2),it[1]-b/2*K],dt=[it[0]-N*I,it[1]-b/2*K];4==I&&0==t&&(dt=[it[0]+10,it[1]-b/2*K],st=[it[0]+10,P[1]]);const ft=[P[0]+I*N+15,yt[1]];for(let t=0;t<X[0].length;t++){let e=[pt[0]+Z*t+Z/2,pt[1]];et.push(e)}for(let t=0;t<I;t++){let e=[dt[0]+N*t+N/2,dt[1]];ot.push(e)}m.log("curNode",R,l.Ys(R).selectAll(".frame"));const vt=1e3,gt=500,ht=250*I,_t=l.Ys(".mats").append("g"),Ct=10;let Yt=ft[0];const wt=ft[1]+b;0==t&&34==F&&(Yt+=100);let It=(0,c.Rv)(Yt,wt,K,N,I,C,t),bt=[{func:()=>(0,c.PY)(Q,j,P,Z,b,_,M,z,K),delay:1500},{func:()=>{(0,u.C)(_t,Yt,wt-30,"./assets/SVGs/matmul.svg"),(0,n._T)(Q,Yt,wt-36,"Click for Animation","procVis"),(0,c.yP)([P],st)},delay:1e3},{func:()=>{(0,c.g)(Yt,wt,K,N,b,I,C,t,_,Q,It)},delay:gt},{func:()=>(0,c.OI)(Q,J,st,b,N,_,C[t],et,ot,K,It,I,j),delay:gt},{func:()=>(0,c.v)(Q,I,b,N,at,_,nt,t),delay:gt},{func:()=>(0,c.tY)(L,S,A,k,t,I),delay:gt},{func:()=>(0,c.au)(it,yt,mt,k,t,I),delay:1},{func:()=>(0,c.D1)(ut,it,L,k),delay:gt},{func:()=>{R.style.opacity="1"},delay:gt},{func:()=>{l.Ys(".ctrlBtn").style("pointer-events","auto")},delay:1}];function Nt(){return m.log("return intervalID",H),H}"tanh"==G&&(bt[7].func=()=>(0,c.TO)(ut,it,L,k)),c.vB.runAnimations(0,bt);let Vt=!0;return _t.on("mouseover",(function(t,e){const[o,s]=l.cx$(t);(0,y.Oy)(o,s,"Matrix Multiplication","Click the icon to show the matrix multiplication process!")})),_t.on("mouseout",(function(t,e){l.td_(".math-displayer").remove()})),_t.on("click",(function(e,o){if(m.log("currentStep 1",B),m.log("isPlaying",x),e.stopPropagation(),H&&clearInterval(H),!x||B>=I||0==B){_t.selectAll("*").remove(),(0,u.C)(_t,Yt,wt-30,"./assets/SVGs/playBtn_pause.svg"),Vt&&(l.td_(".removeRect").remove(),Vt=!1),m.log("currentStep",B),4==I&&2==t&&B>=2&&(l.Ys(".mats").selectAll(".removeRect").remove(),l.td_("#tempath").remove(),l.Ys(".wMatLink").style("opacity",1),l.td_(".matmul-displayer").remove(),B=0),B>=I&&(l.Ys(".mats").selectAll(".removeRect").remove(),B=0);const e=$.transpose(C[t]);l.Ys(".wMatLink").style("opacity",.3),H=setInterval((()=>{(0,c.sy)(C[t],B,et,ot,K,_,I,st,b,N,J,Q,It,j),l.td_(".columnUnit").style("opacity",0),l.td_(".weightUnit").style("opacity",.3).lower(),l.td_("#weightUnit-".concat(B)).style("opacity",1).raise(),l.Ys("#columnUnit-".concat(B)).style("opacity",1).raise(),B++,m.log("currentStep",B),4==I&&2==t&&B>=2&&(l.td_("#tempath").remove(),l.Ys(".wMatLink").style("opacity",1),l.td_(".matmul-displayer").remove(),l.td_(".weightUnit").style("opacity",1),l.td_(".columnUnit").style("opacity",0),(0,u.C)(_t,Yt,wt-30,"./assets/SVGs/matmul.svg"),x=!1,clearInterval(H)),B>=I&&l.Ys(".mats").select(".ctrlBtn").style("pointer-events","none"),(B>=I||!Y)&&(l.td_("#tempath").remove(),l.Ys(".wMatLink").style("opacity",1),l.td_(".matmul-displayer").remove(),l.td_(".weightUnit").style("opacity",1),l.td_(".columnUnit").style("opacity",0),(0,u.C)(_t,Yt,wt-30,"./assets/SVGs/matmul.svg"),x=!1,clearInterval(H))}),200),w(H),x=!0}else x&&(_t.selectAll("*").remove(),(0,u.C)(_t,Yt,wt-30,"./assets/SVGs/playBtn_play.svg"),x=!1);l.td_("#tempath").lower()})),{getIntervalID:Nt,recordLayerID:o,colorSchemesTable:a,featureVisTable:d,features:f}}function w(t,e,o,p,d,f,v){const g=300,h=l.jvg().curve(l.$0Z);let _,C,Y,w=0,I=!1,b=null;const N=15,V=5,F=(0,s.qo)(".mats",".pooling");let D=(0,s.I8)(F);D[0][1]+=15,D[0][0]-=2.5*f,F[0][0]+=1.5*f;const G=(0,n.Pl)();F[0][1]+=10,o=(0,s.I8)(F);let L=(0,s.I8)(F),S;L[0][0]+=f,o[0][1]-=7.5,(0,s.I8)(F)[0][1]+=300,l.td_(".twoLayer").style("pointer-events","none"),l.td_("path").style("opacity",0),l.td_(".featureVis").style("opacity",.2),l.td_(".oFeature").style("opacity",.2),null==t||t.style("opacity",.2);const A=4;(0,n.pg)(4,300),o[0][0]+=350;let k=(0,s.I8)(o),B=[];for(let t=0;t<f;t++){let e=[D[0][0]+5*t+2.5,D[0][1]-N+2];B.push(e)}let x=[];for(let t=0;t<2;t++)x.push([o[0][0]+N*t+7.5,o[0][1]]);const E=[[o[0][0]-150-7.5,o[0][1]],[o[0][0]-150+7.5,o[0][1]]],M=[[o[0][0]-150,o[0][1]],[o[0][0]-150+N,o[0][1]]];let U=(0,s.I8)(x);U[0][1]+=N,U[1][1]+=N;const R=l.Ys(".mats").append("g").attr("class","procVis"),T=[o[0][0],o[0][1]+7.5];let P=(0,s.I8)(x);P[0][0]+=118.75,P[1][0]+=118.75,P[0][1]+=N,P[1][1]+=N,m.log("comp coord",P,x),_=(0,s.I8)(k),_[0][0]-=160,_[0][1]-=50;const O=G.bias[3],$=[p[0]-O[0],p[1]-O[1]];l.Ys(".twoLayer").style("pointer-events","none");const q=(0,s.I8)(_);_[0][0]+=30,Y=[o[0][0],o[0][1]+7.5],C=(0,a.bv)(_[0],Y);const j=[E[0][0],E[0][1]+7.5],z=[E[0][0]+30,E[0][1]+7.5],J=[o[0][0],o[0][1]+7.5],X=l.Ys(".mats").append("g").attr("class","ctrlBtn"),Q=10,Z=(L[0][0]+j[0])/2,H=j[1]-7.5,K=undefined,W=(0,i.U)(r.$,{}).transpose(G.weights[3]);let tt=null;m.log("w mat pos",W);let et=(0,c.Rv)(Z+42,H+30,-1,5,f,[W],0);m.log("w mat pos 1",et);const ot=[{func:()=>{(0,c.v)(R,O.length,N,N,q[0],d,O,4)},delay:200},{func:()=>{(0,c.XQ)(_,C,Y)},delay:200},{func:()=>{(0,c.g)(Z,H+30,-1,5,N,f,[W],0,d,R,et)},delay:g},{func:()=>{m.log("Xv check wmat",W),(0,c.OI)(R,$,j,N,N,d,W,B,M,1,et,f,v)},delay:200},{func:()=>{(0,c.OI)(R,p,T,N,N,d,W,B,M,1,et,f,v,"procVis wRect"),(0,c.yP)([L[0]],j),(0,c.yP)([z],J)},delay:200},{func:()=>{tt=(0,c.UM)(U,P,p,d)},delay:200},{func:()=>{X.selectAll("*").remove(),(0,u.C)(X,Z,H,"./assets/SVGs/matmul.svg"),(0,n._T)(R,Z,H-12,"Click for Animation","procVis")},delay:200}],lt=[{func:()=>{b=setInterval((()=>{const t=undefined,e=G.weights[3][w];(0,c.sy)(W,w,B,M,1,d,0,[E[0][0],E[0][1]+7.5],N,N,p,R,et,v),l.td_(".columnUnit").style("opacity",0),l.td_(".weightUnit").style("opacity",.3).lower(),l.td_("#weightUnit-".concat(w)).style("opacity",1).raise(),l.Ys("#columnUnit-".concat(w)).style("opacity",1).raise(),w++,m.log("i",w),w>=2&&(l.td_(".matmul-displayer").remove(),l.td_(".weightUnit").style("opacity",1),l.td_(".columnUnit").style("opacity",0),X.selectAll("*").remove(),(0,u.C)(X,Z,H,"./assets/SVGs/matmul.svg"),clearInterval(b),l.td_("#tempath").transition().delay(200).duration(200).remove())}),250),l.td_("path").lower(),l.td_("path").lower()},delay:g}];c.vB.runAnimations(0,ot),l.td_(".resultRect").style("pointer-events","auto").on("mouseover",(function(t){t.stopPropagation(),m.log("IN!");const e=Number(l.Ys(this).attr("id"));null!=tt&&(0,y.jN)(tt,x,p,e,d)})).on("mouseout",(function(t){l.td_(".math-displayer").remove();const e=Number(l.Ys(this).attr("id"));null!=tt&&(tt[0][e].style.opacity="0.1",tt[1][e].style.opacity="0.1")}));let st=!0;X.on("mouseover",(function(t,e){const[o,s]=l.cx$(t);(0,y.Oy)(o,s,"Matrix Multiplication","Click the icon to show the matrix multiplication process!")})),X.on("mouseout",(function(t,e){l.td_(".math-displayer").remove()})),X.on("click",(function(t,e){m.log("isPlaying",I),t.stopPropagation(),st&&(l.Ys(".mats").selectAll(".removeRect").remove(),st=!1),b&&clearInterval(b),!I||w>=2||0==w?(l.td_("#tempath").remove(),l.Ys(".wMatLink").style("opacity",1),l.td_(".matmul-displayer").remove(),(0,u.C)(X,Z,H,"./assets/SVGs/matmul.svg"),w>=2&&(l.td_(".matmul-displayer").remove(),l.Ys(".wMatLink").style("opacity",1),l.td_("#tempath").remove(),l.Ys(".mats").selectAll(".removeRect").remove(),w=0),lt[0].delay=1,c.vB.runAnimations(0,lt),I=!0):I&&(X.selectAll("*").remove(),(0,u.C)(X,Z,H,"./assets/SVGs/playBtn_pause.svg"),I=!1),l.td_("path").lower()}));for(let t=0;t<4;t++)e[t].style.opacity="0.2";return{resultVis:t,colorSchemesTable:e}}var I=o(5108);function b(t,e,o,s,i,r,c,u,y,m,C){let b=null,N=null,V=null,F=null;const D=(0,n.Pl)();I.log("weights, data",D);const G=D.weights,L=D.bias;I.log("weights, data",G,L);let S=[[],[],[],[]],A=[],k=!1,B=!1;var x={features:[],GCNConv1:[],GCNConv2:[],GCNConv3:[]},E=[];I.log("Received",C),I.log("adjList",m);const M=(0,a.v4)(y,t,400);let U=M.colFrames,R=M.matFrames;const T=(0,a._O)(t,y,o,e,x,E,S,7,10,15,100);t=T.locations,x=T.frames,E=T.schemeLocations,S=T.featureVisTable;const P=T.firstLayer,O=64,$=(0,a.i5)(s,i,r,t,o,x,E,S,c,y,A,N,V,u,P,C,O);t=$.locations,x=$.frames,E=$.schemeLocations,S=$.featureVisTable,A=$.colorSchemesTable,N=$.poolingVis,V=$.outputVis,F=$.resultVis,C=$.maxVals;let q=$.path1,j=$.fr1,z=$.poolingFrame,J=$.paths,X=$.one;clearInterval(b),l.td_(".oFeature").on("mouseover",(function(t,e){if(!B){const t=undefined,e=undefined,o=p(l.Ys(this).attr("layerID"),l.Ys(this).attr("node"),x,R);x=o.frames,R=o.matFrames}})),l.td_(".oFeature").on("mouseout",(function(t,e){const o=undefined,s=undefined,n=v(l.Ys(this).attr("layerID"),l.Ys(this).attr("node"),x,R);x=n.frames,R=n.matFrames}));let Q=-1,Z="GCNConv",H=null,K=null;function W(t){b=t,I.log("Interval ID set to:",b)}function tt(){return I.log("get interval ID from vGCF",b),b}return l.td_(".mats, .switchBtn").on("click",(function(t,e){if((!t.target||"btn"!==t.target.id)&&B){const e=g(t,k,B,Z,Q,K,H,N,A,O,100,[]);k=e.dview,B=e.lock,Z=e.transState,Q=e.recordLayerID,K=e.poolingOutEvent,H=e.poolingOverEvent,A=e.colorSchemesTable,I.log("interval .mats",b),clearInterval(b)}})),l.td_(".featureVis").on("click",(function(t,n){if(1!=B){Z="GCNConv",B=!0,t.stopPropagation(),k=!0,I.log("click! - fVis",k,B),l.td_(".oFeature").style("pointer-events","none").style("opacity",.2),l.Ys(".pooling").style("pointer-events","none").style("opacity",.2),l.td_(".twoLayer").style("pointer-events","none").style("opacity",.2),l.td_(".crossConnection").style("opacity",0),l.td_(".featureVis").style("opacity",.2),l.td_(".oFeature").style("opacity",.2);const n=undefined,a=undefined,r=Y(Number(l.Ys(this).attr("layerID"))-1,Number(l.Ys(this).attr("node")),Q,A,m,S,e,s,i,L,o,G,B,W,O,15,5,100,7,10);Q=r.recordLayerID,A=r.colorSchemesTable,S=r.featureVisTable,e=r.features,b=r.getIntervalID(),I.log("interval",b)}})),l.td_(".featureVis").on("mouseover",(function(t,e){if(!B){const t=undefined,e=undefined,o=h(Number(l.Ys(this).attr("layerID"))-1,Number(l.Ys(this).attr("node")),J,x,m,R,U,O);J=o.paths,x=o.frames,R=o.matFrames,U=o.colFrames}})),l.td_(".featureVis").on("mouseout",(function(t,e){if(!B){const t=undefined,e=undefined,o=_(Number(l.Ys(this).attr("layerID"))-1,Number(l.Ys(this).attr("node")),J,x,m,R,U);J=o.paths,x=o.frames,R=o.matFrames,U=o.colFrames}})),null!=V&&(l.td_(".resultRect").style("pointer-events","auto").on("mouseover",(function(t,e){d()})),l.td_(".resultRect").style("pointer-events","auto").on("mouseout",(function(t,e){f()})),l.td_(".resultRect").style("pointer-events","auto").on("click",(function(t,e){if(1!=B){l.Ys(".pooling").style("pointer-events","none"),Z="output",B=!0,t.stopPropagation(),k=!0,I.log("click! - fVis",k,B);const e=w(F,A,X,u,o,O,c);F=e.resultVis,A=e.colorSchemesTable}}))),{getIntervalID:tt}}function N(t,e,o,s,m,d,f,w,b,N,V,F){let D=null,G=null,L=null,S=null;const A=(0,n.vJ)();I.log("weights, data",A);const k=A.weights,B=A.bias;I.log("weights, data",k,B);let x=[[],[],[],[],[]],E=[],M=!1,U=!1;var R={features:[],GCNConv1:[],GCNConv2:[],GCNConv3:[],results:[]},T=[];I.log("Received",V),I.log("adjList",N);const P=(0,a.v4)(b,t,800);let O=P.colFrames,$=P.matFrames;const q=(0,a._O)(t,b,o,e,R,T,x,34,5,15,150);t=q.locations,R=q.frames,T=q.schemeLocations,x=q.featureVisTable;const j=q.firstLayer,z=4,J=(0,a.ql)(s,m,d,t,o,R,T,x,f,b,E,w,j,V,4,F);t=J.locations,R=J.frames,T=J.schemeLocations,x=J.featureVisTable,E=J.colorSchemesTable,V=J.maxVals;let X=J.resultLabelsList,Q=J.paths,Z=J.resultPaths;I.log("resultPaths in nc",Z),l.td_(".oFeature").on("mouseover",(function(t,e){if(!U){const t=undefined,e=undefined,o=p(l.Ys(this).attr("layerID"),l.Ys(this).attr("node"),R,$);R=o.frames,$=o.matFrames}})),l.td_(".oFeature").on("mouseout",(function(t,e){const o=undefined,s=undefined,n=v(l.Ys(this).attr("layerID"),l.Ys(this).attr("node"),R,$);R=n.frames,$=n.matFrames}));let H=-1,K="GCNConv",W=null,tt=null;function et(t){D=t,I.log("Interval ID set to:",D)}function ot(){return I.log("get interval ID from vGCF",D),D}return l.td_(".featureVis").on("mouseover",(function(t,e){if(!U){const t=undefined,e=undefined,o=h(Number(l.Ys(this).attr("layerID"))-1,Number(l.Ys(this).attr("node")),Q,R,N,$,O,4);Q=o.paths,R=o.frames,$=o.matFrames,O=o.colFrames}})),l.td_(".featureVis").on("mouseout",(function(t,e){if(!U){const t=undefined,e=undefined,o=_(Number(l.Ys(this).attr("layerID"))-1,Number(l.Ys(this).attr("node")),Q,R,N,$,O);Q=o.paths,R=o.frames,$=o.matFrames,O=o.colFrames}})),l.td_(".resultVis").on("mouseover",(function(t,e){if(!U){const t=Number(l.Ys(this).attr("node"));C(t,Z,R,N,$,O,"1","1"),X[t].style.fill="black"}})),l.td_(".resultVis").on("mouseout",(function(t,e){if(!U){const t=Number(l.Ys(this).attr("node"));C(t,Z,R,N,$,O,"0.25","0.25"),X[t].style.fill="gray"}})),l.td_(".mats, .switchBtn").on("click",(function(t,e){if((!t.target||"btn"!==t.target.id)&&U){l.td_(".resultVis").style("pointer-events","auto").style("opacity",1);const e=g(t,M,U,K,H,tt,W,G,E,4,90,X);M=e.dview,U=e.lock,K=e.transState,H=e.recordLayerID,tt=e.poolingOutEvent,W=e.poolingOverEvent,E=e.colorSchemesTable,I.log("interval .mats",D),clearInterval(D)}})),l.td_(".featureVis").on("click",(function(t,n){if(1!=U){K="GCNConv",U=!0,t.stopPropagation(),M=!0,I.log("click! - fVis",M,U),l.td_(".resultVis").style("pointer-events","none").style("opacity",.2),l.td_(".oFeature").style("pointer-events","none").style("opacity",.2),l.Ys(".pooling").style("pointer-events","none").style("opacity",.2),l.td_(".twoLayer").style("pointer-events","none").style("opacity",.2),l.td_(".crossConnection").style("opacity",0),l.td_(".featureVis").style("opacity",.2),l.td_(".oFeature").style("opacity",.2);const n=undefined,a=undefined,i=Y(Number(l.Ys(this).attr("layerID"))-1,Number(l.Ys(this).attr("node")),H,E,N,x,e,s,m,B,o,k,U,et,4,15,10,90,34,5,"tanh");H=i.recordLayerID,E=i.colorSchemesTable,x=i.featureVisTable,e=i.features,D=i.getIntervalID(),I.log("interval",D)}})),l.td_(".resultVis").on("click",(function(t,e){if(1!=U){K="resultLayer",U=!0,t.stopPropagation(),M=!0,I.log("click! - fVis",M,U),l.td_(".resultVis").style("pointer-events","none").style("opacity",.2),l.td_(".oFeature").style("pointer-events","none").style("opacity",.2),l.Ys(".pooling").style("pointer-events","none").style("opacity",.2),l.td_(".twoLayer").style("pointer-events","none").style("opacity",.2),l.td_(".crossConnection").style("opacity",0),l.td_(".featureVis").style("opacity",.2),l.td_(".oFeature").style("opacity",.2);const e=3,s=Number(l.Ys(this).attr("node"));(0,n.pg)(3,250),I.log("CST before modification",E),E.forEach(((t,e)=>{I.log("Before modification: Element ".concat(e," opacity"),t.style.opacity),t.style.opacity="0.2",I.log("After modification: Element ".concat(e," opacity"),t.style.opacity)})),E[e].style.opacity="1",E[e+1].style.opacity="1",x[e][s].style.opacity="1";let m=x[e+1][s];m.style.opacity="0.25",l.Ys(m).selectAll(".frame").attr("opacity",1);let p=(0,n.mA)(x,e,s,2,34,10,5),v=[p[0]+150,p[1]],g=[p[0]+150+40,p[1]],h=[p[0]+450,p[1]],_=1;s<17&&(_=-1);let C=[p[0]+150,p[1]+50*_],Y=[p[0]+250,p[1]],b=[Y[0],Y[1]],N=[b[0]-60,b[1]],V=[C[0]+40,C[1]];const F=p[1]-7.5*_;let G=[[p[0]-5,p[1]-7.5*_],[p[0]-15,p[1]-7.5*_]],L=[[v[0]+5,F],[v[0]+15,F],[v[0]+25,F],[v[0]+35,F]];const S=p[1]-7.5*_;let A=[[b[0]+5,S],[b[0]+15,S],[b[0]+25,S],[b[0]+35,S]],k=[[h[0]+5,S],[h[0]+15,S],[h[0]+25,S],[h[0]+35,S]];const B=(0,n.vJ)(),R=B.bias[3],T=B.weights[3],P=w[s],O=(0,i.U)(r.$,{}),$=[d[s][0],d[s][1]],q=O.multiply($,O.transpose(T));I.log("data fetching in the NC result layer",R,T,P,d,q);const j=l.Ys(".mats"),z=(0,a.bv)(V,Y),J=z[0],Q=z[1];let Z=0;s<17&&(Z=1),I.log("smart ui",x),s<17?(x[3][s+1].style.opacity="0",x[3][s+2].style.opacity="0",x[4][s+1].style.opacity="0",x[4][s+2].style.opacity="0"):(x[3][s-1].style.opacity="0",x[3][s-2].style.opacity="0",x[4][s-1].style.opacity="0",x[4][s-2].style.opacity="0");const H=l.Ys(".mats").append("g").attr("class","ctrlBtn"),W=10,tt=(p[0]+v[0])/2,et=p[1]-7.5;let ot=0;const lt=300,st=500,nt=l.Ys(".mats").append("g").attr("class","procVis");let at=null;const it=O.transpose(B.weights[3]);let rt=(0,c.Rv)(tt,et+30,_,15,4,[it],0);const ct=[{func:()=>{(0,c.g)(tt,et+15,1,15,15,4,[it],0,o,nt,rt)},delay:st},{func:()=>{const t=B.weights[3],e=[d[s][0],d[s][1]];I.log("data fetching wv 1",e),(0,c.OI)(j,q,v,15,10,o,it,G,L,_,rt,4,e),(0,c.yP)([p],v)},delay:st},{func:()=>{(0,c.OI)(j,P,b,15,10,o,it,G,L,_,rt,4,$,"procVis wRect"),(0,c.yP)([N],b)},delay:st},{func:()=>{(0,c.v)(j,4,15,10,C,o,R,4)},delay:st},{func:()=>{(0,c.tY)(V,J,Q,Y,4,4)},delay:st},{func:()=>{(0,c.yP)([g],h)},delay:st},{func:()=>{let t=1;1==Z&&(t=0),at=(0,c.UM)(A,k,P,o,t)},delay:st},{func:()=>{x[4][s].style.opacity="1",X[s].style.fill="black"},delay:st}],ut=[{func:()=>{D=setInterval((()=>{const t=undefined,e=B.weights[3][ot];(0,c.sy)(it,ot,G,L,_,o,0,v,15,10,q,nt,rt,$),l.td_(".columnUnit").style("opacity",0),l.td_(".weightUnit").style("opacity",.3).lower(),l.td_("#weightUnit-".concat(ot)).style("opacity",1).raise(),l.Ys("#columnUnit-".concat(ot)).style("opacity",1).raise(),ot++,I.log("i",ot),ot>=4&&(l.td_(".weightUnit").style("opacity",1),l.td_(".columnUnit").style("opacity",0),H.selectAll("*").remove(),(0,u.C)(H,tt,et,"./assets/SVGs/matmul.svg"),l.td_("#tempath").remove(),l.td_(".matmul-displayer").remove(),clearInterval(D))}),250),l.td_("path").lower(),l.td_("path").lower()},delay:lt+st}];c.vB.runAnimations(0,ct);let yt=!1;setTimeout((()=>{(0,u.C)(H,tt,et,"./assets/SVGs/matmul.svg")}),lt+2*st);let mt=!0;H.on("mouseover",(function(t,e){const[o,s]=l.cx$(t);(0,y.Oy)(o,s,"Matrix Multiplication","Click the icon to show the matrix multiplication process!")})),H.on("mouseout",(function(t,e){l.td_(".math-displayer").remove()})),H.on("click",(function(t,e){mt&&(l.td_(".removeRect").remove(),mt=!1),I.log("isPlaying",yt),t.stopPropagation(),D&&clearInterval(D),!yt||ot>=4||0==ot?(l.td_("#tempath").remove(),l.td_(".matmul-displayer").remove(),H.selectAll("*").remove(),(0,u.C)(H,tt,et,"./assets/SVGs/playBtn_pause.svg"),ot>=4&&(l.td_("#tempath").remove(),l.td_(".matmul-displayer").remove(),l.Ys(".mats").selectAll(".removeRect").remove(),l.Ys(".mats").selectAll(".pauseRemove").remove(),ot=0,x[4][s].style.opacity="0.25",X[s].style.fill="gray"),ut[0].delay=1,c.vB.runAnimations(0,ut),yt=!0):yt&&(H.selectAll("*").remove(),(0,u.C)(H,tt,et,"./assets/SVGs/playBtn_play.svg"),yt=!1),l.td_("path").lower()})),l.Ys(".mats").selectAll("rect#resultRect".concat(s)).style("pointer-events","auto").on("mouseover",(function(t,e){if(null!=at){const t=["Softmax Score for 'Class A'","Softmax Score for 'Class B'","Softmax Score for 'Class C'","Softmax Score for 'Class D'"],e=l.Ys(this).attr("rectID");I.log("resultRect event",s,e);const n=f[s];I.log("data fetching result rect",at,n,P,t[Number(e)]);for(let t=0;t<at.length;t++)at[t][e].style.opacity="1";let a=[p[0]+275,p[1]-100*_];(0,y.Se)(a,t,Number(e),P,n,o)}})),l.Ys(".mats").selectAll("rect#resultRect".concat(s)).style("pointer-events","auto").on("mouseout",(function(t,e){if(null!=at){const t=l.Ys(this).attr("rectID");for(let e=0;e<at.length;e++)at[e][t].style.opacity="0.1";l.td_(".math-displayer").remove()}}))}})),null}var V=o(4801),F=o(5108);function D(t){let e=Math.abs(Math.max(...t)),o=Math.abs(Math.min(...t));return o>e?o:e}async function G(t,e,o,a,i){F.log("start initNodeC");let r=null,c=(0,s.qt)(t),u=[],y=[],m=[],p=[],d=null;if(F.log("intmData",o),null!=o){let t=D(o.conv1);F.log("conv1Max",t);let e=D(o.conv2);F.log("conv2Max",e);let l=D(o.conv3);F.log("conv3Max",l);let n=D(o.final);F.log("finalMax",n);let a=D(o.result.map((t=>Array.from(t))).flat());F.log("resultMax",a,o.result.flat()),r={conv1:t,conv2:e,conv3:l,final:n,result:a},F.log("From Visualizer:",o),u=(0,s.uL)(o.conv1,4),y=(0,s.uL)(o.conv2,4),m=(0,s.uL)(o.conv3,2),p=o.result,d=(0,s.uL)(o.final,4)}F.log("path ",a);const f=t.length;F.log("gLen",f);const v=800,g={top:10,right:80,bottom:30,left:80},h=20*f+50+612+2400,_=2*(v+g.top+g.bottom);let C=[];l.Ys("#matvis").selectAll("*").remove(),(0,V.v7)(v,t,h,_,g);var Y=l.BYU().domain([-3,-1,-.1,0,.1,1,3]).range(["#304E30","#3DBA41","#B7EFB8","white","#BBB7EF","#6E09CD","#4B0092"]);const w=(0,s.G)(t);C=(0,n.w$)(w,C);const I=N(C,e,Y,u,y,m,p,d,t,c,r,i);F.log("initNode",o,w,C,c),F.log("conv",u,y,m,d,p),F.log("initNode CST",r),F.log("initNode features",e)}async function L(t,e,o,a,i){let r=null,c=(0,s.qt)(t),u=[],y=[],m=[],p=[],d=null;if(F.log("intmData",a),null!=a){let t=D(a.conv1);F.log("conv1Max",t);let e=D(a.conv2);F.log("conv2Max",e);let o=D(a.conv3);F.log("conv3Max",o);let l=D(a.pooling);F.log("poolingMax",l);let n=D(a.dropout);F.log("dropMax",n);let i=D(a.final);F.log("finalMax",i),r={conv1:t,conv2:e,conv3:o,pooling:l,dropout:n,final:i},F.log("From Visualizer:",a),u=(0,s.uL)(a.conv1),y=(0,s.uL)(a.conv2),m=(0,s.uL)(a.conv3),p=a.pooling,d=a.final}F.log("from mat vis pooling",p),F.log("path ",i);let f=[];const v=t.length;F.log("gLen",v);const g=400,h={top:10,right:80,bottom:30,left:80},_=20*v+50+612+2400,C=2*(g+h.top+h.bottom);let Y=[];l.Ys("#matvis").selectAll("*").remove(),(0,V.v7)(g,t,_,C,h);var w=l.BYU().domain([-3,-1,-.1,0,.1,1,3]).range(["#304E30","#3DBA41","#B7EFB8","white","#BBB7EF","#6E09CD","#4B0092"]);const I=(0,s.G)(t);Y=(0,n.w$)(I,Y);const N=b(Y,e,w,u,y,m,p,d,t,c,r);(0,n.hY)(o,t,50);const G=N.getIntervalID();F.log("get interval ID init G",G),clearInterval(G)}async function S(t,e,o){try{t(!0),F.log("path matvis",e);const l=await(0,s.LU)(e);F.log("data matvis",l),F.log("data.x",l.x);const a=(0,n.GF)(l);F.log("node attr array",a);const i=await(0,s.Gh)(l);F.log("o features",i);const r=await(0,s.qb)(l);F.log("pData matvis",r),await L(r,i,a,o,e)}catch(t){F.error("Error in visualizeGNN:",t)}finally{t(!1)}}async function A(t,e,o){try{t(!0),F.log("path matvis",e);const l=await(0,s.LU)(e);F.log("data matvis",l);const n=l.train_nodes;F.log("train nodes",n);const a=await(0,s.Gh)(l);F.log("o features",a);const i=await(0,s.qb)(l);F.log("pData matvis",i),await G(i,a,o,e,n)}catch(t){F.error("Error in visualizeGNN:",t)}finally{t(!1)}}}}]);