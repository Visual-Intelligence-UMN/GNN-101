(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[896],{5538:function(t,a,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/GraphVisualizer",function(){return e(3983)}])},3983:function(t,a,e){"use strict";e.r(a);var n=e(5893),r=e(7294),o=e(2434),c=e(7340),l=e(4801),s=e(5725),i=e(3164),u=e(5108);const y=t=>{let{graph_path:a,intmData:e,changed:y,predicted:d,selectedButtons:f,simulationLoading:x,setSimulation:h}=t;const p=(0,r.useRef)(null),[g,m]=(0,r.useState)(!0),w=(0,r.useRef)(e),v=(0,r.useRef)(null),k=(0,r.useRef)(0);null!=e&&u.log("From Visualizer:",e),(0,r.useEffect)((()=>{h(!1);const t=++k.current,n=async(t,n)=>{null!=e&&u.log("From Visualizer:",e),u.log("path",a);let r=[];const l=600,y=10,d=undefined,f=undefined,x=undefined,h=4800-40-30,p=1e3-y-30;o.Ys("#my_dataviz").selectAll("svg").remove();const g=o.Ys("#my_dataviz").append("svg").attr("width",h).attr("height",p);v.current=g.node();let w=[];t.forEach(((a,d)=>{u.log("i",d),u.log(a);let f=(d-2.5)*l;d>=4&&(f=(d-2.5)*l-1.5*d*25);const x=g.append("g").attr("class","layerVis").attr("transform","translate(".concat(f,",").concat(y,")")).attr("layerNum",d),v=x.selectAll("line").data(a.links).join("line").style("stroke","#aaa"),k=x.selectAll("circle").data(a.nodes).join("circle").attr("r",17).style("fill","white").style("stroke","#69b3a2").style("stroke-width",1).style("stroke-opacity",1).attr("opacity",1),_=x.selectAll("text").data(a.nodes).join("text").text((t=>t.id)).attr("font-size","17px");function b(){const t=o.Wem(a.links,(t=>t.weight)),e=o.BYU().domain(t).range([1,10]),n=o.BYU().domain(t).range([.1,1]);v.attr("x1",(t=>t.source.x)).attr("y1",(t=>t.source.y)).attr("x2",(t=>t.target.x)).attr("y2",(t=>t.target.y)).attr("transform",(function(t){if("double"===t.type){const a=t.target.x-t.source.x,e=t.target.y-t.source.y,n=Math.sqrt(a*a+e*e),r=undefined,o=-a/n*5;return"translate(".concat(e/n*5,", ").concat(o,")")}return null})).style("stroke",(function(t){return"aromatic"===t.type?"purple":"#aaa"})),k.attr("cx",(t=>t.x)).attr("cy",(t=>t.y)),_.attr("x",(t=>t.x-6)).attr("y",(t=>t.y+6))}function E(){v.attr("x1",(t=>t.source.x)).attr("y1",(t=>t.source.y)).attr("x2",(t=>t.target.x)).attr("y2",(t=>t.target.y)).attr("transform",(function(t){if("double"===t.type){const a=t.target.x-t.source.x,e=t.target.y-t.source.y,n=Math.sqrt(a*a+e*e),r=undefined,o=-a/n*5;return"translate(".concat(e/n*5,", ").concat(o,")")}return null})).style("stroke",(function(t){return"aromatic"===t.type?"purple":"#aaa"})),k.attr("cx",(t=>t.x)).attr("cy",(t=>t.y)),_.attr("x",(t=>t.x-6)).attr("y",(t=>t.y+6));let n=[];if(null!=e&&(1===d&&(n=e.conv1),2===d&&(n=e.conv2),3===d&&(n=e.conv3),4===d&&(n=e.pooling),5===d)){let t=e.final;n=(0,c.XA)(t)}a.nodes.forEach((t=>{t.graphIndex=d,null!=n&&d<=4&&n instanceof Float32Array&&(t.features=n.subarray(64*t.id,64*(t.id+1))),null!=n&&d>=5&&(t.features=n),r.push(t)}));let o=0,y=0;const f=a.nodes.slice(0,17);f.forEach((t=>{f.forEach((a=>{if(t!==a){const e=Math.abs(t.x-a.x),n=Math.abs(t.y-a.y);e>o&&(o=e),n>y&&(y=n)}}))}));const h=o+20,m=y+20,b={x:1800,y:p/8},E={x:1740,y:p/20},z={x:1740,y:p/1.7},A={x:1800,y:p/1.5},N=Math.abs(b.x-E.x),M=Math.abs(b.y-A.y),V=(b.x+z.x)/2,C=(b.y+z.y)/2,S=140;let Y=(h+S+20)/N,L=(m+S+20)/M,R="translate(".concat(V,", ").concat(C,") scale(").concat(Y,", ").concat(L,") translate(").concat(-V,", ").concat(-C,")");h+S<N&&m+S<M&&(R="scale(1, 1)");const T=b.x,j=A.y+100;d>=4&&(b.y-=130,E.y-=130,z.y+=70,A.y+=70,b.x+=15,A.x+=15,E.x-=15,z.x-=15);const B=x.append("polygon").attr("points","".concat(b.x,",").concat(b.y," ").concat(E.x,",").concat(E.y," ").concat(z.x,",").concat(z.y," ").concat(A.x,",").concat(A.y)).attr("stroke","black").attr("fill","none").attr("transform",R);let F=" ";0==d&&(F="Input"),d<=3&&0!=d&&(F="GCNConv".concat(d)),4===d&&(F="Pooling"),5===d&&(F="Prediction Result");const I=x.append("text").attr("class","layer-label").attr("x",T).attr("y",j).attr("text-anchor","middle").attr("fill","black").attr("font-size","15px").text(F).attr("font-weight","normal").attr("opacity",.5),P=(0,i.qg)(n);u.log("array value",n);let X=null;X=0==d?(0,s.T1)(c.LV,0,1,F+" Color Scheme",T,j+50,x):5==d?(0,s.T1)(c.LV,n[0],n[1],F+" Color Scheme",T,j+50,x):(0,s.oh)(c.LV,P,F+" Color Scheme",T-50,j+50,x),w.push(X),u.log("colorSchemes",w),d===t.length-1&&((0,c.gL)(r,g,t,l,0),g.selectAll("circle").attr("opacity",0),e&&(0,c.Ts)(g,r,l,p,t,900,600,15,10,3,20,w,0))}d>=4&&_.attr("opacity",0),a.nodes.forEach((t=>{n[t.id]?(t.x=n[t.id].x,t.y=n[t.id].y):(t.x=Math.random()*h,t.y=Math.random()*p),d>=4&&(t.x=1770,t.y=p/3)})),o.A4v(a.nodes).force("link",o.Fsl(a.links).id((t=>t.id)).distance(20)).stop().on("tick",b),E(),m(!1)}))},r=t=>{t===k.current&&h(!0)},f=async()=>{null!=e&&!y||d?(await x(4),r(t)):await(0,l.Ew)(a,(()=>r(t)),!0,0)},x=async t=>{try{m(!0);const e=await(0,c.wb)(a),r=await(0,c.Ke)(t,e),o=(0,l.IO)();await n(r,o)}catch(t){u.error("Error in visualizeGNN:",t)}finally{m(!1)}};f()}),[a,e]);const _=(t,a)=>{o.Ys(t).selectAll(".layerVis").each((function(t,e){const n=undefined;o.Ys(this).selectAll("text.layer-label").transition().duration(140).style("opacity",(()=>e<=2&&a[e]||3===e&&a[4]||4===e&&a[5]||5===e&&a[6]?1:.5)).attr("font-size",(()=>e<=2&&a[e]||3===e&&a[4]||4===e&&a[5]||5===e&&a[6]?"18px":"15px"))}))};return(0,r.useEffect)((()=>{v.current&&!g&&_(v.current,f),u.log("selectBtn",f)}),[f,g]),(0,n.jsx)("div",{id:"my_dataviz",ref:p,style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"start",height:"auto",overflow:"auto",overflowX:"scroll"}})};a.default=y}},function(t){var a=function(a){return t(t.s=a)};t.O(0,[958,978,785,164,888,774,179],(function(){return a(5538)}));var e=t.O();_N_E=e}]);